<h1>Patient Profile</h1>
<h3><?= $this->escapeHtml($this->patient['name']) ?></h3>
<?php if ($this->authService()->hasIdentity() && $this->isAllowed($this->authService()->getIdentity()->role, 'prescription.add')): ?>
    <a href="<?= $this->url('doctor/add-prescription', ['patient_id' => $patient['id']]) ?>" class="btn btn-info btn-sm">Add Prescription</a>
<?php endif; ?>
<div class="row">
    <div class="col-md-6">
        <h4>Personal Info</h4>
        <p><strong>Age:</strong> <?= $this->escapeHtml($this->patient['age']) ?></p>
        <p><strong>Gender:</strong> <?= $this->escapeHtml($this->patient['gender']) ?></p>
        <p><strong>Contact:</strong> <?= $this->escapeHtml($this->patient['contact']) ?></p>
    </div>
    <div class="col-md-6">
        <h4>Medical History</h4>
        <p><?= $this->escapeHtml($this->patient['medical_history']) ?: 'No history recorded' ?></p>
    </div>
</div>
<h4>Prescriptions</h4>
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Medication</th>
            <th>Dosage</th>
        </tr>
    </thead>
    <tbody>
        <?php foreach ($this->prescriptions as $prescription): ?>
            <tr>
                <td><?= $this->escapeHtml($prescription['created_at']) ?></td>
                <td><?= $this->escapeHtml($prescription['medication']) ?></td>
                <td><?= $this->escapeHtml($prescription['dosage']) ?></td>
            </tr>
        <?php endforeach; ?>
    </tbody>
</table>